{
	"info": {
		"_postman_id": "69d5b384-a417-4bf8-86b0-8b485afd1595",
		"name": "PaypalExCollection",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "PaypalAccessToken",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "d70eef94-1f96-4b0f-b12e-5e13f23ea7b3",
						"exec": [
							"//import is with require:",
							"require('btoa');",
							"",
							"",
							"var cId = pm.enviroment.get(\"clientId\");",
							"var cSecret = pm.enviroment.get(\"clientSecret\");",
							"",
							"var encodedVal = btoa(cId + \":\" + cSecret);",
							"",
							"pm.enviroment.set(\"encodedValue\", \"Basic\" + encodedVal);",
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "dc8fff7b-552f-4272-8a59-921fb00b36a9",
						"exec": [
							"//access_token - this is from the response that I didn't get bc I dont have client id or secret",
							"var accessToken = pm.response.json().access_token;",
							"var accessType = pm.response.json().token_type;",
							"",
							"pm.enviroment.set(\"access_token\", tokenType, \" \"+accessToken);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"auth": {
					"type": "basic",
					"basic": [
						{
							"key": "password",
							"value": "admin",
							"type": "string"
						},
						{
							"key": "username",
							"value": "admin",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [
					{
						"warning": "This is a duplicate header and will be overridden by the Authorization header generated by Postman.",
						"key": "Authorization",
						"value": "{{encodedValue}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "grant_type",
							"value": "client_credentials",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "https://api.sandbox.paypal.com/v1/oauth2/token",
					"protocol": "https",
					"host": [
						"api",
						"sandbox",
						"paypal",
						"com"
					],
					"path": [
						"v1",
						"oauth2",
						"token"
					]
				}
			},
			"response": []
		},
		{
			"name": "PaypalPayment",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "0fd3bef8-e1bc-4a28-9cf1-5b04d07b5a6e",
						"exec": [
							"pm.test(\"Verify if status code is 201\", function(){",
							"    pm.response.to.have.status(201);",
							"    pm.expect(pm.response.json().state).is.eq(\"created\")",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "4d2e8aec-c4fd-4b82-9220-97d95a1152ec",
						"exec": [
							"var respHTML = cheerio(pm.response.text());",
							"",
							"var token = respHTML.find('[name = \"_csrf\"]').val();",
							"",
							"console.log(token);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					},
					{
						"key": "Authorization",
						"value": "{{access_token}}",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"intent\": \"sale\",\n  \"payer\": {\n    \"payment_method\": \"paypal\"\n  },\n  \"transactions\": [{\n    \"amount\": {\n      \"total\": \"30.11\",\n      \"currency\": \"USD\",\n      \"details\": {\n        \"subtotal\": \"30.00\",\n        \"tax\": \"0.07\",\n        \"shipping\": \"0.03\",\n        \"handling_fee\": \"1.00\",\n        \"shipping_discount\": \"-1.00\",\n        \"insurance\": \"0.01\"\n      }\n    }"
				},
				"url": {
					"raw": "https://api.sandbox.paypal.com/v1/payment/payment",
					"protocol": "https",
					"host": [
						"api",
						"sandbox",
						"paypal",
						"com"
					],
					"path": [
						"v1",
						"payment",
						"payment"
					]
				}
			},
			"response": []
		}
	],
	"protocolProfileBehavior": {}
}